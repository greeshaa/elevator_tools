<% provide(:title, @node_name) %>
<p class="lead"><%=@node_name %>&nbsp;&nbsp;-&nbsp;&nbsp;<%= @address %></p>
<hr>
<% if @node.street.nil? %>

<% else %>
<div class="col-md-10 col-md-offset-1">


    <div class="col-md-6">
      <div class="panel panel-default">
        <div class="panel-heading">Основные параметры узла
          <div class="btn-group btn-group-xs pull-right">
            <button type="button" class="btn btn-default btn-xs dropdown-toggle " data-toggle="dropdown">Изменить
            <span class="caret"></span>
            </button>
            <ul class="dropdown-menu">
              <li><%= link_to "Узел",         edit_node_path %></li>
              <% if @ipa.empty? %>
              <li><%= link_to "Добавить ip-адрес",     new_node_ip_address_path(@node)  %></li>
              <% else %>
              <% @ipa.each do |ipa| %>
              <li><%= link_to ipa.name + " ip-адрес",     edit_ip_address_path(ipa)  %></li>
              <% end %>
              <li><%= link_to "Добавить ip-адрес",     new_node_ip_address_path(@node)  %></li>
              <% end %>
              <li><%= link_to "Оборудование", '#' %></li>
            </ul>
          </div>
        </div>
        <div class="panel-body">
          Расположение: <%= @node.description %><br>
          Обслуживает <%= @node.lifts.count %> лифтов <br>
          Свободно <%= 64 - @node.lifts.count %> адресов <br>
        </div>
      </div>
    </div>
    <div class="col-md-6">
      <div class="panel panel-default">
        <div class="panel-heading">Сетевые параметры узла</div>
        <div class="panel-body">
          <%= render "nodes/ipa" %>
          <% if @node.dataport == nil %>
          <span class="label label-warning">Порт данных не указан</span><br>
          <% else %>
          Порт данных: &nbsp;<%= @node.dataport %><br>
          <% end %>
          <% if @node.soundport == nil %>
          <span class="label label-warning">Порт звука не указан</span>
          <% else %>
          Порт звука: &nbsp;&nbsp;&nbsp;&nbsp;<%= @node.soundport %>
          <% end %>
        </div>
      </div>
    </div>

    <div class="col-md-6">
      <div class="panel panel-default">
        <div class="panel-heading">Конфигурация ММИ</div>
        <div class="panel-body">
          <table class="table table-striped table-condensed">
            <thead>
              <td class="col-sm-2">№ слота</td>
              <td>Устройство</td>
              <td>Свободно адресов на ЛШ</td>
            </thead>
            <% n = 1 %>
            <% @klsh.each do |klsh| %>
            <tr>
              <td><%= 7 - n %></td>
              <td><%= klsh.equipment_list.name %></td>
              <td></td>
            </tr>
            <% n =+1 %>
            <% end %>
            <tr>
              <td>7</td>
              <td>КСЛ-Eth</td>
              <td></td>
            </tr>  
          </table>
        </div>
      </div>
    </div>
    <div class="col-md-6">
      <div class="panel panel-default">
        <div class="panel-heading">Установленное оборудование</div>
        <div class="panel-body">
          <table class="table table-striped table-condensed">
            <thead>
              <td>Оборудование</td>
              <td>Серийный номер</td>
              <td>Mac адрес</td>
            </thead>
            <tbody>
              <%= render "nodes/equipment" %>
            </tbody>
          </table>
        </div>
      </div>
    </div>
    <div class="col-md-12">
      <div class="panel panel-default">
        <div class="panel-heading">Обслуживаемые лифты
        <div class="btn-group btn-group-xs pull-right">
          <%= link_to "Изменить", nodes_lifts_move_path, class:"btn btn-default btn-xs" %>
        </div>  
        </div>
        <div class="panel-body">
          <table class="table table-striped table-condensed">
            <thead>
              <td>Адрес</td>
              <td>Район</td>
              <td>Прораб</td>
              <td>Механик</td>
              <td>Дата вывода</td>
            </thead>
            <tbody>
              <%= render "nodes/lift" %>
            </tbody>
          </table>
        </div>
      </div>
    </div>

</div>
<% end %> 